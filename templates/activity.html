{% extends "base.html" %}
{% block content %}

<style>
    .tabs {
        display: flex;
        gap: 40px;
        margin-bottom: 25px;
        font-size: 22px;
        font-weight: 700;
    }
    .tab {
        color: #777;
        cursor: pointer;
        text-decoration: none;
        padding-bottom: 3px;
    }
    .active {
        color:#4a64ff;
        border-bottom: 3px solid #4a64ff;
    }

    .card-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
    }

    .card {
        background:white;
        border-radius:14px;
        padding:20px;
        box-shadow:0 4px 15px rgba(0,0,0,0.08);
    }

    .star { color:#ffb400; font-size:20px; }

    .btn {
        background:#4a64ff;
        color:white;
        border:none;
        padding:10px;
        border-radius:8px;
        width:100%;
        margin-top:10px;
        cursor:pointer;
    }
    .btn-outline {
        background:white;
        border:2px solid #4a64ff;
        padding:10px;
        border-radius:8px;
        width:100%;
        color:#4a64ff;
        margin-top:10px;
        cursor:pointer;
    }
    .btn-gray {
        background:#ddd;
        color:#555;
        border:none;
        padding:10px;
        border-radius:8px;
        width:100%;
        margin-top:10px;
        cursor:default;
        text-align:center;
    }
</style>

<!-- ========================= -->
<!--        TAB MENU           -->
<!-- ========================= -->
<div class="tabs">
    <a href="/activity?view=all" class="tab {% if view=='all' %}active{% endif %}">ì „ì²´ í™œë™</a>
    <a href="/activity?view=liked" class="tab {% if view=='liked' %}active{% endif %}">ì°œí•œ í™œë™</a>
    <a href="/activity?view=applied" class="tab {% if view=='applied' %}active{% endif %}">ì‹ ì²­í•œ í™œë™</a>
</div>

<!-- ========================= -->
<!--      ACTIVITY LIST        -->
<!-- ========================= -->
<div class="card-grid">

{% for act in activities %}
    <div class="card">

        <h3>{{ act[1] }}</h3>
        <p style="color:#557;">{{ act[2] }}</p>

        <p style="margin-top:6px;">{{ act[3] }}</p>

        <p style="margin-top:6px; font-size:14px;">
            ğŸ“… {{ act[4] }} ~ {{ act[5] }}
        </p>

        <p style="margin-top:6px; font-size:14px;">
            ğŸ‘¥ {{ act[7] }}/{{ act[6] }} ëª… ì°¸ì—¬ì¤‘
        </p>

        {% set score = act[8] if act[8] and act[8] > 0 else 1 %}
        <div style="margin-top:10px; font-size:20px;">
            {% for i in range(1, 6) %}
                {% if i <= score %}
                    <span class="star">â˜…</span>
                {% else %}
                    <span class="star" style="color:#ddd;">â˜…</span>
                {% endif %}
            {% endfor %}
        </div>

        {% if act[9] %}
        <p style="margin-top:6px; font-size:14px;">
            <span style="font-weight:600;">ì¶”ì²œ ì´ìœ :</span> {{ act[9] }}
        </p>
        {% endif %}

        <!-- ì°œí•˜ê¸° -->
        <form method="POST" action="/activity/favorite/{{ act[0] }}">
            {% if act[0] in liked %}
                <button class="btn-gray">â™¥ ì°œ í•´ì œ</button>
            {% else %}
                <button class="btn-outline">â™¡ ì°œí•˜ê¸°</button>
            {% endif %}
        </form>

        <!-- ============================= -->
        <!--        ì‹ ì²­ ìƒíƒœ ì²˜ë¦¬        -->
        <!-- ============================= -->
        {% if act[0] in applied %}

            {% if applied[act[0]] == 'pending' %}
                <div class="btn-gray">ëŒ€ê¸° ì¤‘</div>

                <form method="POST" action="/activity/cancel/{{ act[0] }}">
                    <button class="btn-outline" style="margin-top:8px;">ì§€ì› ì·¨ì†Œ</button>
                </form>

            {% elif applied[act[0]] == 'accepted' %}
                <button class="btn-gray">ì°¸ì—¬ í™•ì •</button>

            {% elif applied[act[0]] == 'rejected' %}
                <button class="btn-gray">ê±°ì ˆë¨</button>

            {% endif %}

        {% else %}
            <!-- ì‹ ì²­ ì•ˆ í–ˆì„ ë•Œ -->
            <form method="POST" action="/activity/apply/{{ act[0] }}">
                <button class="btn">ì§€ì›í•˜ê¸°</button>
            </form>
        {% endif %}

    </div>
{% endfor %}

</div>

{% endblock %}
