{% extends "base_no_nav.html" %}
{% block content %}

<h2 class="section-title">Leader Dashboard</h2>

<!-- Tabs -->
<div class="tabs">
    <div class="tab active" id="tab-info" onclick="showTab('info')">í´ëŸ½ ì •ë³´</div>
    <div class="tab" id="tab-notice" onclick="showTab('notice')">ê³µì§€ì‚¬í•­</div>
    <div class="tab" id="tab-applicants" onclick="showTab('applicants')">ì§€ì›ì ëª©ë¡</div>
    <div class="tab" id="tab-members" onclick="showTab('members')">ë©¤ë²„ ê´€ë¦¬</div>
    <div class="tab" id="tab-activity" onclick="showTab('activity')">í™œë™ ê¸°ë¡</div>
</div>

<script>
function showTab(name) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(s => s.style.display = 'none');

    document.getElementById("tab-" + name).classList.add("active");
    document.getElementById("content-" + name).style.display = "block";
}
document.addEventListener("DOMContentLoaded", () => showTab("info"));
</script>

<style>
.tabs { display:flex; gap:30px; margin-bottom:20px; font-size:20px; font-weight:700; }
.tab { cursor:pointer; color:#666; padding-bottom:6px; }
.tab.active { color:#4a64ff; border-bottom:3px solid #4a64ff; }
.card { background:white; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin-bottom:20px; }
</style>

<!-- ========================= 1) í´ëŸ½ ì •ë³´ ========================= -->
<div class="tab-content" id="content-info">

    <h3>í´ëŸ½ ì •ë³´ ìˆ˜ì •</h3>

    <div class="card">
        <form method="POST" action="/leader/club/edit/{{ club.club_id }}">
            <div class="form-group">
                <label class="form-label">ë™ì•„ë¦¬ ì´ë¦„</label>
                <input class="form-input" name="name" value="{{ club.name }}">
            </div>

            <div class="form-group">
                <label class="form-label">ìœ í˜•</label>
                <input class="form-input" name="type" value="{{ club.type }}">
            </div>

            <div class="form-group">
                <label class="form-label">í™œë™ ë¹ˆë„</label>
                <input class="form-input" name="activity_frequency" value="{{ club.activity_frequency }}">
            </div>

            <div class="form-group">
                <label class="form-label">ìµœëŒ€ ì¸ì›</label>
                <input class="form-input" type="number" name="max_members" value="{{ club.max_members }}">
            </div>

            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea class="form-input" name="description">{{ club.description }}</textarea>
            </div>

            <button class="btn" style="margin-top:12px;">ì €ì¥í•˜ê¸°</button>
        </form>
    </div>
</div>

<!-- ========================= 2) ê³µì§€ì‚¬í•­ ========================= -->
<div class="tab-content" id="content-notice" style="display:none;">

    <h3>ğŸ“¢ ê³µì§€ ë“±ë¡</h3>

    <div class="card">
        <form method="POST" action="/leader/notice/add">
            <input type="text" name="title" placeholder="ì œëª©" class="form-input" required>
            <textarea name="content" placeholder="ë‚´ìš©" class="form-input" style="height:120px;" required></textarea>
            <button class="btn" style="width:100%; margin-top:10px;">ë“±ë¡í•˜ê¸°</button>
        </form>
    </div>

    <h3 style="margin-top:30px;">ğŸ“„ ë“±ë¡ëœ ê³µì§€</h3>

    {% for n in notices %}
    <div class="card">
        <h4>{{ n.title }}</h4>
        <p>{{ n.content }}</p>
        <small>{{ n.created_at }}</small>
    </div>
    {% endfor %}
</div>

<!-- ========================= 3) ì§€ì›ì ëª©ë¡ ========================= -->
<div class="tab-content" id="content-applicants" style="display:none;">

    <h3>ğŸ™‹ ì§€ì›ì ëª©ë¡</h3>

    {% for a in applicants %}
    <div class="card">
        <p><b>{{ a.student_id }}</b> í•™ìƒ ì§€ì›</p>
        <p>ìƒíƒœ: {{ a.status }}</p>

        {% if a.status == 'pending' %}
        <form method="POST" action="/leader/apply/approve/{{ a.log_id }}">
            <button class="btn">ìŠ¹ì¸</button>
        </form>
        <form method="POST" action="/leader/apply/reject/{{ a.log_id }}">
            <button class="btn-outline" style="margin-top:10px;">ê±°ì ˆ</button>
        </form>
        {% endif %}
    </div>
    {% endfor %}
</div>

<!-- ========================= 4) ë©¤ë²„ ê´€ë¦¬ ========================= -->
<div class="tab-content" id="content-members" style="display:none;">

    <h3>ğŸ‘¥ ìŠ¹ì¸ëœ ë©¤ë²„</h3>

    <table class="table">
        <tr>
            <th>ì´ë¦„</th>
            <th>ë‹‰ë„¤ì„</th>
            <th>ê°€ì…ì¼</th>
            <th>ê´€ë¦¬</th>
        </tr>

        {% for m in members %}
        <tr>
            <td>{{ m.name }}</td>
            <td>{{ m.nickname }}</td>
            <td>{{ m.joined_date }}</td>
            <td>
                <form method="POST" action="/leader/member/kick/{{ m.membership_id }}">
                    <button class="btn-warning btn">ê°•í‡´</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- ========================= 5) í™œë™ ê¸°ë¡ ========================= -->
<div class="tab-content" id="content-activity" style="display:none;">

    <h3>ğŸ“ í™œë™ ê¸°ë¡ ì¶”ê°€</h3>
    <div class="card">
        <form method="POST" action="/leader/activity/add">
            <input type="text" name="title" class="form-input" placeholder="í™œë™ ì œëª©" required>
            <textarea name="content" class="form-input" placeholder="í™œë™ ë‚´ìš©" style="height:120px;" required></textarea>
            <button class="btn" style="width:100%; margin-top:10px;">ë“±ë¡</button>
        </form>
    </div>

    <h3 style="margin-top:30px;">ê¸°ë¡ëœ í™œë™</h3>

    {% for act in activities %}
    <div class="card">
        <h4>{{ act.title }}</h4>
        <p>{{ act.content }}</p>
        <small>{{ act.created_at }}</small>
    </div>
    {% endfor %}
</div>

<!-- ========================= ë¡œê·¸ì•„ì›ƒ ========================= -->
<div style="text-align:center; margin-top:40px;">
    <a href="/logout" class="btn-outline" style="width:200px; display:inline-block;">ë¡œê·¸ì•„ì›ƒ</a>
</div>

{% endblock %}
