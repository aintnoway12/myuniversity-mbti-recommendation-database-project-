{% extends "base.html" %}
{% block content %}

<h2 class="section-title">{{ club[1] }} 관리</h2>

<div class="card">

    <h3>클럽 정보 수정</h3>

    <form method="POST" action="/club/manage/{{ club[0] }}/edit">

        <div class="form-group">
            <label class="form-label">동아리 이름</label>
            <input class="form-input" name="name" value="{{ club[1] }}">
        </div>

        <div class="form-group">
            <label class="form-label">유형</label>
            <input class="form-input" name="type" value="{{ club[2] }}">
        </div>

        <div class="form-group">
            <label class="form-label">활동 빈도</label>
            <input class="form-input" name="activity_frequency" value="{{ club[3] }}">
        </div>

        <div class="form-group">
            <label class="form-label">최대 인원</label>
            <input class="form-input" name="max_members" type="number" value="{{ club[4] }}">
        </div>

        <div class="form-group">
            <label class="form-label">설명</label>
            <textarea class="form-input" name="description">{{ club[6] }}</textarea>
        </div>

        <button class="btn" style="margin-top:12px;">변경사항 저장</button>
    </form>

</div>

<hr style="margin:40px 0;">

<h3 class="section-title">가입 신청자 관리</h3>

<form method="GET">
    <div class="card" style="padding:20px;">

        <div class="form-group">
            <input class="form-input" name="search" placeholder="이름/닉네임 검색" value="{{ request.args.get('search','') }}">
        </div>

        <div class="form-group">
            <select class="form-input" name="filter">
                <option value="">전체 상태</option>
                <option value="pending" {% if request.args.get('filter') == 'pending' %}selected{% endif %}>대기</option>
                <option value="approved" {% if request.args.get('filter') == 'approved' %}selected{% endif %}>승인됨</option>
                <option value="rejected" {% if request.args.get('filter') == 'rejected' %}selected{% endif %}>거절됨</option>
                <option value="kicked" {% if request.args.get('filter') == 'kicked' %}selected{% endif %}>강퇴됨</option>
            </select>
        </div>

        <button class="btn" style="width:100%;">검색</button>

    </div>
</form>

<table class="table" style="margin-top:25px;">
    <tr>
        <th>이름</th>
        <th>닉네임</th>
        <th>상태</th>
        <th>신청일</th>
        <th>관리</th>
    </tr>

    {% for m in members %}
    <tr class="table-row">
        <td>{{ m[2] }}</td>
        <td>{{ m[3] }}</td>
        <td>{{ m[4] }}</td>
        <td>{{ m[5] }}</td>

        <td>
            {% if m[4] == "pending" %}

                <form method="POST" action="/club/manage/{{ club[0] }}/approve/{{ m[0] }}" style="display:inline;">
                    <button class="btn-success btn">승인</button>
                </form>

                <form method="POST" action="/club/manage/{{ club[0] }}/reject/{{ m[0] }}" style="display:inline;">
                    <button class="btn-danger btn">거절</button>
                </form>

            {% elif m[4] == "approved" %}

                <form method="POST" action="/club/manage/{{ club[0] }}/kick/{{ m[0] }}" style="display:inline;">
                    <button class="btn-warning btn">강퇴</button>
                </form>

            {% else %}
                {{ m[4] }}
            {% endif %}
        </td>

    </tr>
    {% endfor %}
</table>

<h3>지원자 목록</h3>

{% for a in applications %}
    {{ a[1] }} 학생 — {{ a[3] }}
    <form action="/club/manage/{{ club[0] }}/application/approve/{{ a[0] }}" method="post">
        <button>승인</button>
    </form>
{% endfor %}

{% endblock %}
